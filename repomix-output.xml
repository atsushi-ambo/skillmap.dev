This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
4. Repository files, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

<additional_info>

</additional_info>

</file_summary>

<directory_structure>
docs/
  img/
    icons/
      cloud.svg
      cost.svg
      monitor.svg
      network.svg
      scale.svg
  ops-essentials/
    index.md
    level1.md
    level2.md
    level3.md
    level4.md
  index.md
ops-essentials/
  games/
    01-network/
      checker.py
      docker-compose.yml
      nginx.conf
      quest.md
    02-monitor/
      app.py
      checker.py
      docker-compose.yml
      Dockerfile.flask
      prometheus.yml
      quest.md
      requirements.txt
    03-backup/
      checker.py
      docker-compose.yml
      quest.md
      redis-init.sh
      redis.conf
    04-ha/
      haproxy.cfg
tools/
  cli/
    game.py
.gitignore
docker-compose.yml
mkdocs.yml
README.md
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="docs/img/icons/cloud.svg">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg>
</file>

<file path="docs/img/icons/cost.svg">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v20"></path><path d="M2 8h20"></path><path d="M2 16h20"></path><path d="M6 6h12v12H6z"></path></svg>
</file>

<file path="docs/img/icons/monitor.svg">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
</file>

<file path="docs/img/icons/network.svg">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect><rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect><line x1="6" y1="6" x2="6.01" y2="6"></line><line x1="6" y1="18" x2="6.01" y2="18"></line></svg>
</file>

<file path="docs/img/icons/scale.svg">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3v18"></path><path d="M2 12h20"></path><path d="M18 6l-4 4-4-4"></path><path d="M6 18l4-4 4 4"></path></svg>
</file>

<file path="docs/ops-essentials/index.md">
# Ops Essentials

![Cloud Icon](../img/icons/cloud.svg){ .icon style="color:#3B82F6" }

ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ãªã‚¤ãƒ³ãƒ•ãƒ©é‹ç”¨ã®åŸºç¤ã‚’å­¦ã¶ã‚³ãƒ¼ã‚¹ã§ã™ã€‚

## ã‚³ãƒ¼ã‚¹æ§‹æˆ

1. **Foundations** - ã‚¤ãƒ³ãƒ•ãƒ©ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åŸºç¤
2. **Ops Routine** - ç›£è¦–ã€ãƒ­ã‚°ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®åŸºæœ¬
3. **Scale & HA** - ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã¨é«˜å¯ç”¨æ€§ã®åŸºæœ¬
4. **Design & Cost** - ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã¨è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³

## å­¦ç¿’æ–¹æ³•

å„ãƒ¬ãƒ™ãƒ«ã¯ä»¥ä¸‹ã®æ§‹æˆã«ãªã£ã¦ã„ã¾ã™ï¼š

- **å­¦ç¿’ç›®æ¨™** - ãã®ãƒ¬ãƒ™ãƒ«ã§ç¿’å¾—ã™ã¹ãã‚¹ã‚­ãƒ«
- **ä¸»è¦ã‚³ãƒ³ã‚»ãƒ—ãƒˆ** - é‡è¦ãªæ¦‚å¿µã®èª¬æ˜
- **ãƒãƒ³ã‚ºã‚ªãƒ³** - å®Ÿéš›ã«æ‰‹ã‚’å‹•ã‹ã™æ¼”ç¿’
- **ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ** - ç†è§£åº¦ç¢ºèªã®ãŸã‚ã®ã‚¯ã‚¤ã‚º

## å¿…è¦ãªç’°å¢ƒ

- æœ€æ–°ã®ã‚¦ã‚§ãƒ–ãƒ–ãƒ©ã‚¦ã‚¶
- Docker ã¨ Docker Compose ãŒå‹•ä½œã™ã‚‹ç’°å¢ƒï¼ˆãƒãƒ³ã‚ºã‚ªãƒ³ç”¨ï¼‰
- ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼ˆã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ï¼‰ã®åŸºæœ¬çš„ãªæ“ä½œçŸ¥è­˜

[Level 1 ã‚’å§‹ã‚ã‚‹ â†’](level1.md){ .md-button .md-button--primary }
</file>

<file path="docs/ops-essentials/level1.md">
# Level 1 â€” Foundations { #level1 }
![Network Icon](../img/icons/network.svg){ .icon style="color:#3B82F6" }

!!! abstract "å­¦ç¿’ã‚´ãƒ¼ãƒ«"
    1. ã‚¤ãƒ³ãƒ•ãƒ©ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª¬æ˜ã§ãã‚‹  
    2. HTTP/DNS/SSL ã®å½¹å‰²ã‚’ç†è§£ã™ã‚‹  
    3. ãƒãƒ³ã‚ºã‚ªãƒ³ç’°å¢ƒã‚’æ“ä½œã§ãã‚‹

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ—©è¦‹è¡¨

| ã‚«ãƒ†ã‚´ãƒª | ä»£è¡¨ä¾‹ | ã²ã¨ã“ã¨ã§è¨€ã†ã¨ |
|---|---|---|
| **Web Server** | Nginx, Apache | HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã™ã‚‹ |
| **App Server** | Gunicorn, uWSGI | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ |
| **Database** | PostgreSQL, MySQL | æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’æ°¸ç¶šåŒ– |
| **KVS** | Redis | ãƒ¡ãƒ¢ãƒªç‰¹åŒ–ã®è¾æ›¸ |
| **Queue** | RabbitMQ | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡Œåˆ— |
| **CDN** | CloudFront | é™çš„ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç¶² |

## ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åŸºç¤

### HTTP/HTTPS
- **HTTP (80)**: ã‚¦ã‚§ãƒ–é€šä¿¡ã®åŸºæœ¬ãƒ—ãƒ­ãƒˆã‚³ãƒ«
- **HTTPS (443)**: æš—å·åŒ–ã•ã‚ŒãŸHTTPé€šä¿¡

```mermaid
graph LR
  Client -->|HTTPS| LB[Load Balancer]
  LB -->|HTTP| Web1[Web Server 1]
  LB -->|HTTP| Web2[Web Server 2]
```

!!! info "ç”¨èªãƒãƒ¼ãƒˆ"
    ãƒãƒ¼ãƒˆç•ªå·ã¯ "ã‚¢ãƒ—ãƒªã®ç„é–¢"ã€‚HTTP=80, HTTPS=443 ãŒæ¨™æº–ã€‚

### DNS ã®ä»•çµ„ã¿
1. ãƒ–ãƒ©ã‚¦ã‚¶ãŒDNSã‚µãƒ¼ãƒãƒ¼ã«å•ã„åˆã‚ã›
2. ãƒ‰ãƒ¡ã‚¤ãƒ³å â†’ IPã‚¢ãƒ‰ãƒ¬ã‚¹ ã«å¤‰æ›
3. æ¥ç¶šå…ˆãŒæ±ºå®š

## ãƒãƒ³ã‚ºã‚ªãƒ³: åˆã‚ã¦ã®Webã‚µãƒ¼ãƒãƒ¼

!!! warning "Lab 01 - Webã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¦ã¦ã¿ã‚ˆã†"
    Docker Compose ã§ Nginx ã‚’èµ·å‹•ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèªã—ã¾ã™ã€‚

```bash
docker compose up -d web
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:8080` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## ç« æœ«ãƒã‚§ãƒƒã‚¯

???+ quiz "ç†è§£åº¦ãƒã‚§ãƒƒã‚¯"
    ? DNS ãŒè§£æ±ºã™ã‚‹ã®ã¯ï¼Ÿ
    - [ ] OS ãƒãƒ¼ã‚¸ãƒ§ãƒ³
    - [x] ãƒ›ã‚¹ãƒˆå â†’ IP
    - [ ] TCP ãƒãƒ¼ãƒˆ
    - [ ] CPU æ¸©åº¦

    ? HTTPSã®æ¨™æº–ãƒãƒ¼ãƒˆç•ªå·ã¯ï¼Ÿ
    - [ ] 80
    - [x] 443
    - [ ] 22
    - [ ] 3306

[æ¬¡ã®ãƒ¬ãƒ™ãƒ«ã¸ â†’](../ops-essentials/level2.md){ .md-button }
</file>

<file path="docs/ops-essentials/level2.md">
# Level 2 â€” Ops Routine { #level2 }
![Monitor Icon](../img/icons/monitor.svg){ .icon style="color:#10B981" }

!!! abstract "å­¦ç¿’ã‚´ãƒ¼ãƒ«"
    1. ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–ã®åŸºæœ¬ã‚’ç†è§£ã™ã‚‹  
    2. ãƒ­ã‚°ç®¡ç†ã®é‡è¦æ€§ã‚’å­¦ã¶  
    3. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥ã‚’è¨­è¨ˆã§ãã‚‹

## ç›£è¦–ã®åŸºæœ¬

### ç›£è¦–ã®4ã¤ã®è¦³ç‚¹
1. **ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–** (CPU, ãƒ¡ãƒ¢ãƒª, ãƒ‡ã‚£ã‚¹ã‚¯)
2. **ã‚µãƒ¼ãƒ“ã‚¹ç›£è¦–** (HTTP, TCP)
3. **ãƒ­ã‚°ç›£è¦–** (ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°, ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°)
4. **ãƒ“ã‚¸ãƒã‚¹KPI** (ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°, ã‚¨ãƒ©ãƒ¼ç‡)

## ãƒãƒ³ã‚ºã‚ªãƒ³: ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰

!!! warning "Lab 02 - ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã‚ˆã†"
    Prometheus ã¨ Grafana ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

```bash
docker compose up -d prometheus grafana
```

Grafana ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

[æ¬¡ã®ãƒ¬ãƒ™ãƒ«ã¸ â†’](../ops-essentials/level3.md){ .md-button }
</file>

<file path="docs/ops-essentials/level3.md">
# Level 3 â€” Scale & HA { #level3 }
![Scale Icon](../img/icons/scale.svg){ .icon style="color:#F59E0B" }

!!! abstract "å­¦ç¿’ã‚´ãƒ¼ãƒ«"
    1. ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã®åŸºæœ¬ã‚’ç†è§£ã™ã‚‹  
    2. é«˜å¯ç”¨æ€§ã®ä»•çµ„ã¿ã‚’å­¦ã¶  
    3. ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã‚’è¨­å®šã§ãã‚‹

## ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æˆ¦ç•¥

### ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ— vs ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ
- **ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—**: ã‚µãƒ¼ãƒãƒ¼ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’å¢—å¼·
- **ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ**: ã‚µãƒ¼ãƒãƒ¼å°æ•°ã‚’å¢—ã‚„ã—ã¦åˆ†æ•£

## ãƒãƒ³ã‚ºã‚ªãƒ³: ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼

!!! warning "Lab 03 - ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã‚’è¨­å®šã—ã‚ˆã†"
    HAProxy ã‚’ä½¿ã£ã¦è¤‡æ•°ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«è² è·åˆ†æ•£ã—ã¾ã™ã€‚

```bash
docker compose up -d --scale app=3 haproxy
```

[æ¬¡ã®ãƒ¬ãƒ™ãƒ«ã¸ â†’](../ops-essentials/level4.md){ .md-button }
</file>

<file path="docs/ops-essentials/level4.md">
# Level 4 â€” Design & Cost { #level4 }
![Cost Icon](../img/icons/cost.svg){ .icon style="color:#EC4899" }

!!! abstract "å­¦ç¿’ã‚´ãƒ¼ãƒ«"
    1. ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ã‚¹ãƒˆã®æœ€é©åŒ–æ‰‹æ³•ã‚’å­¦ã¶  
    2. ã‚³ã‚¹ãƒˆåŠ¹ç‡ã®è‰¯ã„è¨­è¨ˆãŒã§ãã‚‹  
    3. ã‚³ã‚¹ãƒˆç›£è¦–ã®ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹

## ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã®åŸºæœ¬

### ã‚³ã‚¹ãƒˆå‰Šæ¸›ã®ãƒã‚¤ãƒ³ãƒˆ
- ä½¿ã£ã¦ã„ãªã„ãƒªã‚½ãƒ¼ã‚¹ã®å‰Šé™¤
- é©åˆ‡ãªã‚µã‚¤ã‚¸ãƒ³ã‚°
- ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ´»ç”¨
- ã‚¹ãƒãƒƒãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ´»ç”¨

## ãƒãƒ³ã‚ºã‚ªãƒ³: ã‚³ã‚¹ãƒˆåˆ†æ

!!! warning "Lab 04 - ã‚³ã‚¹ãƒˆåˆ†æã‚’ã—ã‚ˆã†"
    AWS Cost Explorer ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã§ã‚³ã‚¹ãƒˆåˆ†æã‚’è¡Œã„ã¾ã™ã€‚

```bash
# ã‚³ã‚¹ãƒˆåˆ†æã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
python3 analyze_cost.py
```

## ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼

ã“ã‚Œã§ Ops Essentials ã‚³ãƒ¼ã‚¹ã¯å®Œäº†ã§ã™ï¼

[â† ã‚³ãƒ¼ã‚¹ä¸€è¦§ã«æˆ»ã‚‹](../index.md){ .md-button }
</file>

<file path="docs/index.md">
# Skillmap.dev

> å­¦ç¿’ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã¨ "æ‰‹ã‚’å‹•ã‹ã™" ãƒãƒ³ã‚ºã‚ªãƒ³ã‚’ä¸€ã‹æ‰€ã«ã€‚

<div style="text-align:center">
  <img src="img/icons/cloud.svg" width="80">
</div>

## ã„ã¾èª­ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„

<div class="grid cards" markdown>

- **Ops Essentials** â€“ ã‚¤ãƒ³ãƒ•ãƒ©é‹ç”¨ã®åŸºç¤ã‹ã‚‰ã‚³ã‚¹ãƒˆè¨­è¨ˆã¾ã§  
  [Ops Essentials](ops-essentials/index.md)

- **Coming Soon** â€“ æº–å‚™ä¸­  
  ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’é‹­æ„åˆ¶ä½œä¸­ã§ã™

</div>
</file>

<file path="ops-essentials/games/01-network/checker.py">
#!/usr/bin/env python3
import sys
import urllib.request
import urllib.error
import socket
import json
from typing import Tuple, Dict, Any

def check_ports() -> bool:
    """Check if the port mapping is correct by inspecting the container."""
    import subprocess
    try:
        # Get the container's port mapping
        cmd = [
            'docker', 'inspect',
            '--format', '{{range $p, $conf := .NetworkSettings.Ports}}{{$p}} -> {{(index $conf 0).HostPort}}{{"\n"}}{{end}}',
            'skillmapdev-network_lab-1'
        ]
        result = subprocess.run(cmd, capture_output=True, text=True, check=True)
        
        print("\nğŸ” ç¾åœ¨ã®ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ç¢ºèªä¸­...")
        print(result.stdout.strip())
        
        # Check if port 80 is mapped to 8080
        if '80/tcp -> 8080' in result.stdout:
            print("âœ… ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã¾ã™ (80/tcp -> 8080)")
            return True
        else:
            print("âŒ ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“")
            print("   æœŸå¾…ã•ã‚Œã‚‹ãƒãƒƒãƒ”ãƒ³ã‚°: 80/tcp -> 8080")
            return False
            
    except subprocess.CalledProcessError as e:
        print(f"âŒ ã‚³ãƒ³ãƒ†ãƒŠæƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: {e}")
        return False
    except Exception as e:
        print(f"âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
        return False

def check_nginx() -> Tuple[bool, Dict[str, Any]]:
    """Check if Nginx is responding correctly."""
    try:
        # Check if nginx is accessible on port 8080
        req = urllib.request.Request(
            'http://localhost:8080',
            headers={'User-Agent': 'Skillmap Exercise Checker'}
        )
        
        with urllib.request.urlopen(req, timeout=5) as response:
            content = response.read().decode('utf-8')
            headers = dict(response.getheaders())
            
            return True, {
                'status': response.status,
                'content': content,
                'headers': headers
            }
            
    except urllib.error.HTTPError as e:
        return False, {'error': f'HTTP Error: {e.code} - {e.reason}'}
    except urllib.error.URLError as e:
        if isinstance(e.reason, socket.timeout):
            return False, {'error': 'Request timed out. Is Nginx running?'}
        return False, {'error': f'URL Error: {e.reason}'}
    except Exception as e:
        return False, {'error': f'An error occurred: {str(e)}'}

def check_network() -> bool:
    """Check if the network setup is correct."""
    print("ğŸš€ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã‚’ç¢ºèªä¸­...\n")
    
    # First check the port mapping
    if not check_ports():
        print("\nâŒ ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚")
        print("   docker-compose.yml ã® ports è¨­å®šã‚’ç¢ºèªã—ã€æ­£ã—ã„ãƒãƒƒãƒ”ãƒ³ã‚°ã«ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚")
        print("   ä¾‹: \"8080:80\" (ãƒ›ã‚¹ãƒˆ:ã‚³ãƒ³ãƒ†ãƒŠ)")
        return False
    
    # Then check Nginx response
    success, result = check_nginx()
    
    if success:
        print("\nğŸ”„ Nginx ã®å¿œç­”ã‚’ç¢ºèªä¸­...")
        print(f"   Status: {result['status']}")
        print(f"   Content-Type: {result['headers'].get('Content-Type', 'N/A')}")
        print(f"   X-Network-Exercise: {result['headers'].get('X-Network-Exercise', 'N/A')}")
        
        if 'ãŠã‚ã§ã¨ã†' in result['content']:
            print("\nğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼Nginx ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¾ã—ãŸï¼")
            print("âœ… æ¼”ç¿’ã¯æˆåŠŸã§ã™ï¼")
            return True
        else:
            print("\nâŒ Nginx ã®å¿œç­”ãŒæœŸå¾…ã¨ç•°ãªã‚Šã¾ã™ã€‚")
            print("   nginx.conf ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚")
            return False
    else:
        print("\nâŒ Nginx ã¸ã®æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸã€‚")
        print(f"   ã‚¨ãƒ©ãƒ¼: {result['error']}")
        print("\nãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãƒ’ãƒ³ãƒˆ:")
        print("1. ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª: docker ps")
        print("2. Nginx ã®ãƒ­ã‚°ã‚’ç¢ºèª: docker logs skillmapdev-network_lab-1")
        print("3. ãƒãƒ¼ãƒˆãŒä½¿ç”¨ä¸­ã§ãªã„ã‹ç¢ºèª: lsof -i :8080")
        return False

if __name__ == "__main__":
    success = check_network()
    sys.exit(0 if success else 1)
</file>

<file path="ops-essentials/games/01-network/docker-compose.yml">
version: "3.9"
services:
  nginx:
    image: nginx:1.25-alpine
    ports:
      - "8080:8000"  # Intentionally misconfigured port mapping
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    networks:
      - app-network

networks:
  app-network:
    driver: bridge
</file>

<file path="ops-essentials/games/01-network/nginx.conf">
# This is a basic Nginx configuration file
# It defines how the web server handles incoming requests

events {
    # Maximum number of simultaneous connections per worker process
    worker_connections 1024;
}

http {
    # Define a virtual server
    server {
        # Listen on port 8000 for IPv4 and IPv6
        listen 8000;
        
        # Server name (domain)
        server_name localhost;
        
        # Default location block
        location / {
            # Return a simple text response
            return 200 'ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼Nginx ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¾ã—ãŸï¼\n\n' 
                       'âœ… ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¾ã—ãŸã€‚\n' 
                       'Nginx ã¯ã‚³ãƒ³ãƒ†ãƒŠå†…ã®ãƒãƒ¼ãƒˆ 8000 ã§ãƒªãƒƒã‚¹ãƒ³ã—ã¦ãŠã‚Šã€\n' 
                       'ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã®ãƒãƒ¼ãƒˆ 8080 ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚\n\n' 
                       'ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€æ¼”ç¿’ã¯æˆåŠŸã§ã™ï¼';
            
            # Set the content type to plain text
            add_header Content-Type text/plain;
            
            # Add a custom header for educational purposes
            add_header X-Network-Exercise "Completed";
        }
    }
}
</file>

<file path="ops-essentials/games/01-network/quest.md">
# ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã®ãƒ‡ãƒãƒƒã‚°æ¼”ç¿’

## æ¼”ç¿’ã®ç›®çš„
ã“ã®æ¼”ç¿’ã§ã¯ã€Docker ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã¨ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚
ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å‹•ä½œã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã€ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®åŸºæœ¬çš„ãªè¨­å®šæ–¹æ³•ã‚’ç†è§£ã—ã¾ã™ã€‚

## èª²é¡Œ
Nginx ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã‚ˆã†ã«ã€`docker-compose.yml` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚

## ç¾åœ¨ã®çŠ¶æ…‹
- Nginx ã¯ã‚³ãƒ³ãƒ†ãƒŠå†…ã® 8000 ç•ªãƒãƒ¼ãƒˆã§ãƒªãƒƒã‚¹ãƒ³ã™ã‚‹ã‚ˆã†ã«è¨­å®šã•ã‚Œã¦ã„ã¾ã™
- ã—ã‹ã—ã€`docker-compose.yml` ã®ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“

## ç›®æ¨™
1. `docker-compose.yml` ã‚’ç·¨é›†ã—ã¦ã€ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã® 8080 ç•ªãƒãƒ¼ãƒˆãŒ Nginx ã‚³ãƒ³ãƒ†ãƒŠã® 8000 ç•ªãƒãƒ¼ãƒˆã«æ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
2. ä¿®æ­£å¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§å‹•ä½œç¢ºèªã™ã‚‹
   ```bash
   python3 tools/cli/game.py play 01-network
   ```

## ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

1. ã¾ãšã€`docker-compose.yml` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ãã ã•ã„
   ```bash
   code ops-essentials/games/01-network/docker-compose.yml
   ```

2. `ports` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¾ã™ã€‚ç¾åœ¨ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ï¼š
   ```yaml
   ports:
     - "8080:8000"  # æ„å›³çš„ã«é–“é•ã£ãŸãƒãƒƒãƒ”ãƒ³ã‚°
   ```

3. ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯ `ãƒ›ã‚¹ãƒˆãƒãƒ¼ãƒˆ:ã‚³ãƒ³ãƒ†ãƒŠãƒãƒ¼ãƒˆ` ã§ã™ã€‚
   Nginx ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ 80 ç•ªãƒãƒ¼ãƒˆã§ãƒªãƒƒã‚¹ãƒ³ã™ã‚‹ãŸã‚ã€ã‚³ãƒ³ãƒ†ãƒŠãƒãƒ¼ãƒˆã‚’ 80 ã«å¤‰æ›´ã—ã¾ã™ã€‚

4. ä»¥ä¸‹ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¦ãã ã•ã„ï¼š
   ```yaml
   ports:
     - "8080:80"  # ãƒ›ã‚¹ãƒˆã®8080 â†’ ã‚³ãƒ³ãƒ†ãƒŠã®80
   ```

5. å¤‰æ›´ã‚’ä¿å­˜ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’å†èµ·å‹•ã—ã¾ã™ï¼š
   ```bash
   docker compose --profile game down
   docker compose --profile game up -d
   ```

6. æœ€å¾Œã«ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§æ­£ã—ãä¿®æ­£ã§ããŸã‹ç¢ºèªã—ã¾ã™ï¼š
   ```bash
   python3 tools/cli/game.py play 01-network
   ```

## ãƒ’ãƒ³ãƒˆ
- `docker ps` ã‚³ãƒãƒ³ãƒ‰ã§ã€ã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ç¢ºèªã§ãã¾ã™
- `curl -v http://localhost:8080` ã§ã€Nginx ã®å¿œç­”ã‚’ç›´æ¥ç¢ºèªã§ãã¾ã™
- å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€Nginx ã®ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„ï¼š
  ```bash
  docker logs skillmapdev-network_lab-1
  ```

## ç™ºå±•èª²é¡Œï¼ˆä½™è£•ãŒã‚ã‚Œã°æŒ‘æˆ¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼‰
- ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã®ç•°ãªã‚‹ãƒãƒ¼ãƒˆï¼ˆä¾‹: 8081ï¼‰ã§ Nginx ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«è¨­å®šã‚’å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„
- Nginx ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (`nginx.conf`) ã‚’ç·¨é›†ã—ã¦ã€ã‚«ã‚¹ã‚¿ãƒ ã®ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„
</file>

<file path="ops-essentials/games/02-monitor/app.py">
from flask import Flask, jsonify
import random
import time

app = Flask(__name__)

# Simple counter for requests
request_counter = 0

@app.route('/')
def home():
    global request_counter
    request_counter += 1
    return jsonify({
        'status': 'running',
        'request_count': request_counter,
        'timestamp': time.time()
    })

@app.route('/metrics')
def metrics():
    return f"""# HELP http_requests_total Total number of HTTP requests
# TYPE http_requests_total counter
http_requests_total {request_counter}
"""

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
</file>

<file path="ops-essentials/games/02-monitor/checker.py">
#!/usr/bin/env python3
"""
Prometheus ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒã‚§ãƒƒã‚«ãƒ¼

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€Prometheus ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæ­£ã—ãè¨­å®šã•ã‚Œã€
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒåé›†ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
"""

import json
import sys
import urllib.request
import urllib.error
import socket
from typing import Dict, Any, List, Optional

def get_prometheus_targets() -> Dict[str, Any]:
    """Prometheus ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæƒ…å ±ã‚’å–å¾—ã™ã‚‹"""
    try:
        url = "http://prometheus:9090/api/v1/targets"
        req = urllib.request.Request(url)
        
        with urllib.request.urlopen(req, timeout=10) as response:
            data = json.loads(response.read().decode('utf-8'))
            return data
    except urllib.error.HTTPError as e:
        return {"error": f"HTTP Error: {e.code} - {e.reason}"}
    except urllib.error.URLError as e:
        if isinstance(e.reason, socket.timeout):
            return {"error": "Request timed out. Is Prometheus running?"}
        return {"error": f"URL Error: {e.reason}"}
    except Exception as e:
        return {"error": f"An error occurred: {str(e)}"}

def check_flask_target(targets_data: Dict[str, Any]) -> bool:
    """Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª"""
    if "data" not in targets_data or "activeTargets" not in targets_data["data"]:
        print("âŒ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ")
        return False
    
    active_targets = targets_data["data"]["activeTargets"]
    flask_targets = [t for t in active_targets if t["scrapePool"] == "flask_app"]
    
    print("\nğŸ” ç¾åœ¨ã® Prometheus ã‚¿ãƒ¼ã‚²ãƒƒãƒˆçŠ¶æ…‹:")
    print("-" * 50)
    
    if not flask_targets:
        print("âŒ flask_app ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        return False
    
    all_healthy = True
    for target in flask_targets:
        status = "âœ… UP" if target["health"] == "up" else "âŒ DOWN"
        print(f"{status} - {target['scrapeUrl']} (Job: {target['scrapePool']})")
        
        if target["health"] != "up":
            print(f"   ã‚¨ãƒ©ãƒ¼: {target.get('lastError', 'No error details')}")
            all_healthy = False
    
    return all_healthy

def check_metrics_are_being_collected() -> bool:
    """ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒåé›†ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª"""
    try:
        # ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒåé›†ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        url = "http://prometheus:9090/api/v1/query?query=http_requests_total"
        req = urllib.request.Request(url)
        
        with urllib.request.urlopen(req, timeout=10) as response:
            data = json.loads(response.read().decode('utf-8'))
            
            if data["status"] != "success":
                print("âŒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚¯ã‚¨ãƒªãŒå¤±æ•—ã—ã¾ã—ãŸ")
                return False
                
            if not data["data"]["result"]:
                print("âŒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒåé›†ã•ã‚Œã¦ã„ã¾ã›ã‚“")
                return False
                
            print("\nğŸ“Š ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†çŠ¶æ³:")
            print("-" * 30)
            print(f"âœ… ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒæ­£å¸¸ã«åé›†ã•ã‚Œã¦ã„ã¾ã™")
            for result in data["data"]["result"][:3]:  # æœ€åˆã®3ä»¶ã®ã¿è¡¨ç¤º
                print(f"  - {result['metric'].get('job', 'unknown')}: {result['value'][1]} (at {result['value'][0]})")
            
            return True
            
    except Exception as e:
        print(f"âŒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {str(e)}")
        return False

def main() -> None:
    """ãƒ¡ã‚¤ãƒ³å‡¦ç†"""
    print("ğŸš€ Prometheus ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒã‚§ãƒƒã‚¯ã‚’é–‹å§‹ã—ã¾ã™...")
    
    # 1. Prometheus ã‹ã‚‰ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæƒ…å ±ã‚’å–å¾—
    print("\nğŸ” Prometheus ã‹ã‚‰ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæƒ…å ±ã‚’å–å¾—ä¸­...")
    targets_data = get_prometheus_targets()
    
    if "error" in targets_data:
        print(f"âŒ ã‚¨ãƒ©ãƒ¼: {targets_data['error']}")
        print("\nğŸ’¡ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãƒ’ãƒ³ãƒˆ:")
        print("1. Prometheus ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª: docker ps | grep prometheus")
        print("2. Prometheus ã®ãƒ­ã‚°ã‚’ç¢ºèª: docker compose logs prometheus")
        print("3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã‚’ç¢ºèª: docker network ls ã¨ docker network inspect")
        sys.exit(1)
    
    # 2. Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ç¢ºèª
    print("\nğŸ” Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ç¢ºèªä¸­...")
    if not check_flask_target(targets_data):
        print("\nâŒ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®è¨­å®šã«å•é¡ŒãŒã‚ã‚Šã¾ã™")
        print("\nğŸ’¡ ä¿®æ­£ã®ãƒ’ãƒ³ãƒˆ:")
        print("1. prometheus.yml ã® targets ãŒæ­£ã—ã„ã‹ç¢ºèª")
        print("   - ç¾åœ¨: ['localhost:9999']")
        print("   - æœŸå¾…: ['flask_app:5000']")
        print("2. ä¿®æ­£å¾Œã€docker compose restart prometheus ã§å†èµ·å‹•")
        sys.exit(1)
    
    # 3. ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒåé›†ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
    print("\nğŸ” ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åé›†çŠ¶æ³ã‚’ç¢ºèªä¸­...")
    if not check_metrics_are_being_collected():
        print("\nâŒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒæ­£ã—ãåé›†ã•ã‚Œã¦ã„ã¾ã›ã‚“")
        print("\nğŸ’¡ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãƒ’ãƒ³ãƒˆ:")
        print("1. Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª: docker ps | grep flask")
        print("2. Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚°ã‚’ç¢ºèª: docker compose logs flask_app")
        print("3. http://localhost:5000/metrics ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª")
        sys.exit(1)
    
    # ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã«æˆåŠŸ
    print("\n" + "=" * 50)
    print("âœ… ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã«æˆåŠŸã—ã¾ã—ãŸï¼")
    print("=" * 50)
    print("\nğŸ¯ å­¦ç¿’ã®ãƒã‚¤ãƒ³ãƒˆ:")
    print("- Prometheus ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¨­å®šã‚’ç†è§£ã—ã¾ã—ãŸ")
    print("- ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åé›†æ–¹æ³•ã‚’å­¦ã³ã¾ã—ãŸ")
    print("- ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã®è¨­å®šã¨ãƒ‡ãƒãƒƒã‚°æ–¹æ³•ã‚’å®Ÿè·µã—ã¾ã—ãŸ")
    
    sys.exit(0)

if __name__ == "__main__":
    main()
</file>

<file path="ops-essentials/games/02-monitor/docker-compose.yml">
version: '3.8'

services:
  flask_app:
    build:
      context: .
      dockerfile: Dockerfile.flask
    ports:
      - "5000:5000"
    networks:
      - monitor_net
    restart: unless-stopped

  prometheus:
    image: prom/prometheus:latest
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--web.console.libraries=/usr/share/prometheus/console_libraries'
      - '--web.console.templates=/usr/share/prometheus/consoles'
    networks:
      - monitor_net
    depends_on:
      - flask_app

networks:
  monitor_net:
    driver: bridge

volumes:
  prometheus_data:
</file>

<file path="ops-essentials/games/02-monitor/Dockerfile.flask">
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY app.py .

EXPOSE 5000

CMD ["python", "app.py"]
</file>

<file path="ops-essentials/games/02-monitor/prometheus.yml">
global:
  scrape_interval: 5s
  evaluation_interval: 5s

scrape_configs:
  - job_name: 'flask_app'
    static_configs:
      - targets: ['localhost:9999']  # æ„å›³çš„ã«é–“é•ã£ãŸãƒãƒ¼ãƒˆ

  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
</file>

<file path="ops-essentials/games/02-monitor/quest.md">
# ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°è¨­å®šã®ãƒ‡ãƒãƒƒã‚°

## æ¼”ç¿’ã®ç›®çš„
ã“ã®æ¼”ç¿’ã§ã¯ã€Prometheus ã‚’ä½¿ã£ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç›£è¦–è¨­å®šã‚’å­¦ã³ã¾ã™ã€‚
é–“é•ã£ãŸè¨­å®šã‚’æ­£ã—ãä¿®æ­£ã—ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒæ­£ã—ãåé›†ã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

## ç¾åœ¨ã®çŠ¶æ³

- Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒ `http://flask_app:5000` ã§å‹•ä½œã—ã¦ã„ã¾ã™
- Prometheus ãŒ `http://localhost:9090` ã§å‹•ä½œã—ã¦ã„ã¾ã™
- ã—ã‹ã—ã€Prometheus ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒãƒ€ã‚¦ãƒ³ã—ãŸçŠ¶æ…‹ã«ãªã£ã¦ã„ã¾ã™

## èª²é¡Œ

1. Prometheus ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (`prometheus.yml`) ã‚’ä¿®æ­£ã—ã¦ã€Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„
2. ä¿®æ­£å¾Œã€Prometheus ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ¼ã‚¸ã§ `flask_app` ãŒ `UP` çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„

## ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

1. ã¾ãšã€ç¾åœ¨ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„:
   ```bash
   cat prometheus.yml
   ```

2. å•é¡Œç‚¹ã‚’ç‰¹å®šã—ã¦ãã ã•ã„:
   - Flask ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ `flask_app:5000` ã§å‹•ä½œã—ã¦ã„ã¾ã™
   - ã—ã‹ã—ã€Prometheus ã¯ `localhost:9999` ã‚’ç›£è¦–ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™

3. `prometheus.yml` ã‚’ç·¨é›†ã—ã¦ã€æ­£ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’è¨­å®šã—ã¦ãã ã•ã„:
   ```yaml
   - job_name: 'flask_app'
     static_configs:
       - targets: ['flask_app:5000']  # ã“ã“ã‚’ä¿®æ­£
   ```

4. å¤‰æ›´ã‚’é©ç”¨ã™ã‚‹ãŸã‚ã«ã€Prometheus ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„:
   ```bash
   docker compose restart prometheus
   ```

5. Prometheus ã® Web UI ã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèª:
   - http://localhost:9090/targets ã«ã‚¢ã‚¯ã‚»ã‚¹
   - `flask_app` ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ `UP` ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

6. ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒåé›†ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª:
   - http://localhost:9090/graph ã«ã‚¢ã‚¯ã‚»ã‚¹
   - ã‚¯ã‚¨ãƒªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã« `http_requests_total` ã¨å…¥åŠ›
   - ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸ

## ãƒ’ãƒ³ãƒˆ

- Prometheus ã¯ã‚³ãƒ³ãƒ†ãƒŠé–“ã§é€šä¿¡ã™ã‚‹ãŸã‚ã€ã‚µãƒ¼ãƒ“ã‚¹åã‚’ãƒ›ã‚¹ãƒˆåã¨ã—ã¦ä½¿ç”¨ã§ãã¾ã™
- ãƒãƒ¼ãƒˆç•ªå·ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Ÿéš›ã«ãƒªãƒƒã‚¹ãƒ³ã—ã¦ã„ã‚‹ãƒãƒ¼ãƒˆã¨ä¸€è‡´ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
- å¤‰æ›´å¾Œã¯å¿…ãš Prometheus ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„

## ç¢ºèªæ–¹æ³•

æ¼”ç¿’ãŒå®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§æ­£ã—ãè¨­å®šã§ããŸã‹ç¢ºèªã§ãã¾ã™:

```bash
python3 ../../../../tools/cli/game.py play 02-monitor
```

## ç™ºå±•èª²é¡Œï¼ˆä½™è£•ãŒã‚ã‚Œã°æŒ‘æˆ¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼‰

- Prometheus ã®ã‚¢ãƒ©ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¦ã¿ã¾ã—ã‚‡ã†
- Grafana ã‚’è¿½åŠ ã—ã¦ã€ãƒ€ãƒƒï¿½ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†
- ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è¿½åŠ ã—ã¦ã€Prometheus ã§åé›†ã—ã¦ã¿ã¾ã—ã‚‡ã†
</file>

<file path="ops-essentials/games/02-monitor/requirements.txt">
flask==2.0.1
prometheus-client==0.12.0
</file>

<file path="ops-essentials/games/03-backup/checker.py">
#!/usr/bin/env python3
"""
Redis ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒã‚§ãƒƒã‚«ãƒ¼

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€Redis ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šãŒæ­£ã—ãè¡Œã‚ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
"""

import subprocess
import json
import sys
import time
from datetime import datetime, timedelta
from typing import Dict, Any, Optional, Tuple

def run_command(cmd: str) -> Tuple[bool, str]:
    """ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦çµæœã‚’è¿”ã™"""
    try:
        result = subprocess.run(
            cmd, 
            shell=True, 
            check=True, 
            stdout=subprocess.PIPE, 
            stderr=subprocess.PIPE,
            text=True
        )
        return True, result.stdout.strip()
    except subprocess.CalledProcessError as e:
        return False, f"Command failed with error: {e.stderr}"

def check_redis_running() -> bool:
    """Redis ãŒå®Ÿè¡Œä¸­ã‹ç¢ºèª"""
    print("\nğŸ” Redis ã®å®Ÿè¡ŒçŠ¶æ…‹ã‚’ç¢ºèªä¸­...")
    success, output = run_command("docker compose ps redis | grep Up")
    
    if not success or "redis" not in output:
        print("âŒ Redis ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“")
        print("ğŸ’¡ ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§èµ·å‹•ã—ã¦ãã ã•ã„: docker compose up -d")
        return False
    
    print("âœ… Redis ãŒæ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã™")
    return True

def check_redis_config() -> Dict[str, Any]:
    """Redis ã®è¨­å®šã‚’ç¢ºèª"""
    print("\nğŸ” Redis ã®è¨­å®šã‚’ç¢ºèªä¸­...")
    
    # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å–å¾—
    success, output = run_command("docker compose exec redis cat /usr/local/etc/redis/redis.conf | grep -v '^#' | grep -v '^$'")
    
    if not success:
        print(f"âŒ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: {output}")
        return {}
    
    # è¨­å®šã‚’ãƒ‘ãƒ¼ã‚¹
    config = {}
    for line in output.split('\n'):
        if ' ' in line:
            key, *value = line.split()
            config[key] = ' '.join(value) if len(value) > 1 else value[0]
    
    return config

def check_backup_settings(config: Dict[str, Any]) -> bool:
    """ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã‚’ç¢ºèª"""
    print("\nğŸ” ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã‚’ç¢ºèªä¸­...")
    
    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã‚’å–å¾—
    save_commands = [v for k, v in config.items() if k == 'save']
    
    if not save_commands:
        print("âŒ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        return False
    
    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã‚’è¡¨ç¤º
    print("ç¾åœ¨ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š:")
    for i, save_cmd in enumerate(save_commands, 1):
        print(f"  {i}. {save_cmd}")
    
    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒæœ‰åŠ¹ã‹ãƒã‚§ãƒƒã‚¯
    if any(save_cmd == '\"\"' or save_cmd == "''" for save_cmd in save_commands):
        print("âŒ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™ (save \"\" ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™)")
        return False
    
    # æ¨å¥¨ã•ã‚Œã‚‹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š
    recommended = [
        '900 1',
        '300 10',
        '60 10000'
    ]
    
    # æ¨å¥¨è¨­å®šã¨æ¯”è¼ƒ
    missing = []
    for rec in recommended:
        if not any(rec in save_cmd for save_cmd in save_commands):
            missing.append(rec)
    
    if missing:
        print(f"âŒ æ¨å¥¨ã•ã‚Œã‚‹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šãŒä¸è¶³ã—ã¦ã„ã¾ã™: {', '.join(missing)}")
        return False
    
    print("âœ… ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šãŒæ­£ã—ãæ§‹æˆã•ã‚Œã¦ã„ã¾ã™")
    return True

def check_backup_file() -> bool:
    """ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª"""
    print("\nğŸ” ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªä¸­...")
    
    # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
    success, output = run_command("docker compose exec redis ls -la /data/ | grep dump.rdb")
    
    if not success or 'dump.rdb' not in output:
        print("âŒ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ« (dump.rdb) ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        return False
    
    # ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’å–å¾—
    success, size_output = run_command("docker compose exec redis du -h /data/dump.rdb | cut -f1")
    
    if not success:
        print("âŒ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚µã‚¤ã‚ºã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ")
        return False
    
    # ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’å–å¾—
    success, mtime_output = run_command("docker compose exec redis stat -c '%y' /data/dump.rdb")
    
    if not success:
        print("âŒ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ")
        return False
    
    # ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•æ™‚é–“ã‚’å–å¾—
    success, start_time_output = run_command("docker inspect -f '{{.State.StartedAt}}' redis-backup-demo")
    
    if not success:
        print("âŒ ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•æ™‚é–“ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ")
        return False
    
    # æ—¥æ™‚ã‚’ãƒ‘ãƒ¼ã‚¹
    try:
        file_mtime = datetime.fromisoformat(mtime_output.split('.')[0])
        container_start = datetime.fromisoformat(start_time_output.split('.')[0].replace('Z', '+00:00'))
        now = datetime.now(file_mtime.tzinfo)
        
        print(f"âœ… ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ (ã‚µã‚¤ã‚º: {size_output})")
        print(f"    æœ€çµ‚æ›´æ–°: {file_mtime}")
        print(f"    ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ã‹ã‚‰: {now - container_start} çµŒé")
        
        # ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•å¾Œã«æ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        if file_mtime < container_start:
            print("âŒ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤ã„ã§ã™ã€‚ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•å¾Œã«æ›´æ–°ã•ã‚Œã¦ã„ã¾ã›ã‚“")
            print("ğŸ’¡ SAVE ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ã—ã¦ãã ã•ã„")
            return False
            
    except Exception as e:
        print(f"âŒ æ—¥æ™‚ã®å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {str(e)}")
        return False
    
    return True

def main() -> None:
    """ãƒ¡ã‚¤ãƒ³å‡¦ç†"""
    print("ğŸš€ Redis ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šãƒã‚§ãƒƒã‚¯ã‚’é–‹å§‹ã—ã¾ã™...")
    
    # 1. Redis ãŒå®Ÿè¡Œä¸­ã‹ç¢ºèª
    if not check_redis_running():
        sys.exit(1)
    
    # 2. Redis ã®è¨­å®šã‚’ç¢ºèª
    config = check_redis_config()
    if not config:
        print("âŒ Redis ã®è¨­å®šã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ")
        sys.exit(1)
    
    # 3. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã‚’ç¢ºèª
    if not check_backup_settings(config):
        print("\nğŸ’¡ ä¿®æ­£ã®ãƒ’ãƒ³ãƒˆ:")
        print("1. redis.conf ã‚’ç·¨é›†ã—ã¦ã€ä»¥ä¸‹ã®è¨­å®šã‚’è¿½åŠ ã—ã¦ãã ã•ã„:")
        print("   save 900 1")
        print("   save 300 10")
        print("   save 60 10000")
        print("2. ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ Redis ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„:")
        print("   docker compose restart redis")
        sys.exit(1)
    
    # 4. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
    if not check_backup_file():
        print("\nğŸ’¡ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãƒ’ãƒ³ãƒˆ:")
        print("1. Redis CLI ã§ SAVE ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„:")
        print("   docker compose exec redis redis-cli SAVE")
        print("2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ãã ã•ã„:")
        print("   docker compose exec redis ls -la /data/")
        sys.exit(1)
    
    # ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã«æˆåŠŸ
    print("\n" + "=" * 60)
    print("âœ… ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã«æˆåŠŸã—ã¾ã—ãŸï¼")
    print("=" * 60)
    print("\nğŸ¯ å­¦ç¿’ã®ãƒã‚¤ãƒ³ãƒˆ:")
    print("- Redis ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã‚’ç†è§£ã—ã¾ã—ãŸ")
    print("- ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã®é‡è¦æ€§ã‚’å­¦ã³ã¾ã—ãŸ")
    print("- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®ç®¡ç†æ–¹æ³•ã‚’å®Ÿè·µã—ã¾ã—ãŸ")
    
    sys.exit(0)

if __name__ == "__main__":
    main()
</file>

<file path="ops-essentials/games/03-backup/docker-compose.yml">
version: '3.8'

services:
  redis:
    image: redis:6.2-alpine
    container_name: redis_backup_demo
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
      - ./redis.conf:/usr/local/etc/redis/redis.conf
      - ./redis-init.sh:/docker-entrypoint-initdb.d/redis-init.sh
    command: redis-server /usr/local/etc/redis/redis.conf
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 5s
      timeout: 3s
      retries: 5
    networks:
      - backup_net

  redis_commander:
    image: rediscommander/redis-commander:latest
    container_name: redis_commander
    environment:
      - REDIS_HOSTS=local:redis:6379
    ports:
      - "8081:8081"
    depends_on:
      - redis
    networks:
      - backup_net

networks:
  backup_net:
    driver: bridge

volumes:
  redis_data:
</file>

<file path="ops-essentials/games/03-backup/quest.md">
# Redis ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š

## æ¼”ç¿’ã®ç›®çš„
ã“ã®æ¼”ç¿’ã§ã¯ã€Redis ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã—ã€ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã‚’è¨­å®šã—ã¾ã™ã€‚
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãŒæ°¸ç¶šåŒ–ã•ã‚Œã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

## ç¾åœ¨ã®çŠ¶æ³

- Redis ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã¾ã™ãŒã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã¾ã™
- `save ""` ã®è¨­å®šã«ã‚ˆã‚Šã€å®šæœŸçš„ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™
- ãƒ‡ãƒ¼ã‚¿ã¯ãƒ¡ãƒ¢ãƒªä¸Šã«ã®ã¿å­˜åœ¨ã—ã€ãƒ‡ã‚£ã‚¹ã‚¯ã«ã¯ä¿å­˜ã•ã‚Œã¦ã„ã¾ã›ã‚“

## èª²é¡Œ

1. Redis ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (`redis.conf`) ã‚’ä¿®æ­£ã—ã¦ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’æœ‰åŠ¹ã«ã—ã¦ãã ã•ã„
2. ä»¥ä¸‹ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒãƒªã‚·ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼š
   - 900ç§’ï¼ˆ15åˆ†ï¼‰ä»¥å†…ã«1å›ä»¥ä¸Šã®å¤‰æ›´ãŒã‚ã£ãŸå ´åˆ
   - 300ç§’ï¼ˆ5åˆ†ï¼‰ä»¥å†…ã«10å›ä»¥ä¸Šã®å¤‰æ›´ãŒã‚ã£ãŸå ´åˆ
   - 60ç§’ä»¥å†…ã«10000å›ä»¥ä¸Šã®å¤‰æ›´ãŒã‚ã£ãŸå ´åˆ
3. å¤‰æ›´ã‚’é©ç”¨ã—ã¦ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒæ­£ã—ãä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„

## ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

1. ç¾åœ¨ã®è¨­å®šã‚’ç¢ºèªã—ã¾ã™ï¼š
   ```bash
   docker compose exec redis cat /usr/local/etc/redis/redis.conf | grep -A 5 "^save"
   ```

2. `redis.conf` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã‚’æœ‰åŠ¹ã«ã—ã¾ã™ï¼š
   ```bash
   # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã‚’æœ‰åŠ¹åŒ–
   save 900 1
   save 300 10
   save 60 10000
   
   # ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹è¨­å®šã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
   # save ""
   ```

3. å¤‰æ›´ã‚’é©ç”¨ã™ã‚‹ãŸã‚ã« Redis ã‚’å†èµ·å‹•ã—ã¾ã™ï¼š
   ```bash
   docker compose restart redis
   ```

4. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ï¼š
   ```bash
   docker compose exec redis ls -la /data/
   ```

5. ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã—ã¦ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ï¼š
   ```bash
   # Redis CLI ã«æ¥ç¶š
   docker compose exec redis redis-cli
   
   # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
   SET test_key "This is a test value"
   
   # å¤‰æ›´ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã«åŒæœŸ
   SAVE
   
   # çµ‚äº†
   EXIT
   
   # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
   docker compose exec redis ls -la /data/
   ```

## ãƒ’ãƒ³ãƒˆ

- Redis ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã¯ `save` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã§åˆ¶å¾¡ã—ã¾ã™
- è¨­å®šã‚’å¤‰æ›´ã—ãŸå¾Œã¯ Redis ã‚’å†èµ·å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã¯ `/data/dump.rdb` ã«ä½œæˆã•ã‚Œã¾ã™

## ç¢ºèªæ–¹æ³•

æ¼”ç¿’ãŒå®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§æ­£ã—ãè¨­å®šã§ããŸã‹ç¢ºèªã§ãã¾ã™ï¼š

```bash
python3 ../../../../tools/cli/game.py play 03-backup
```

## ç™ºå±•èª²é¡Œï¼ˆä½™è£•ãŒã‚ã‚Œã°æŒ‘æˆ¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼‰

- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ¥ã®å ´æ‰€ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†
- å®šæœŸçš„ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–å¾—ã™ã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰ã—ã¦ã¿ã¾ã—ã‚‡ã†
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã™ã‚‹æ‰‹é †ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†
</file>

<file path="ops-essentials/games/03-backup/redis-init.sh">
#!/bin/sh
# Redis åˆæœŸåŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

# ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥

# Redis ãŒèµ·å‹•ã™ã‚‹ã®ã‚’å¾…æ©Ÿ
until redis-cli ping &> /dev/null; do
  echo "Waiting for Redis to start..."
  sleep 1
done

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥
echo "Inserting sample data..."
redis-cli set welcome "Hello, Redis Backup Demo!"
redis-cli lpush colors red green blue yellow
redis-cli hset user:1000 name "John Doe" email "john@example.com"

# ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã«åŒæœŸ
echo "Saving data to disk..."
redis-cli save

echo "Redis initialization complete!"
</file>

<file path="ops-essentials/games/03-backup/redis.conf">
# Redis è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ç„¡åŠ¹åŒ–ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã•ã‚Œã¦ã„ã¾ã™ï¼‰
save ""

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã—ã¦è¨­å®šã—ã¾ã™
# save 900 1
# save 300 10
# save 60 10000

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å…ˆ
dir /data

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«å
dbfilename dump.rdb

# ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–è¨­å®š
appendonly no

# ãƒ¡ãƒ¢ãƒªè¨­å®š
maxmemory 100mb
maxmemory-policy allkeys-lru

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
protected-mode yes
bind 0.0.0.0
port 6379

# ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
loglevel notice
logfile "/var/log/redis/redis-server.log"

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ•°
databases 16
</file>

<file path="ops-essentials/games/04-ha/haproxy.cfg">
global
    log /dev/log local0
    log /dev/log local1 notice
    chroot /var/lib/haproxy
    stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners
    stats timeout 30s
    user haproxy
    group haproxy
    daemon

defaults
    log     global
    mode    http
    option  httplog
    option  dontlognull
    timeout connect 5000
    timeout client  50000
    timeout server  50000
    errorfile 400 /etc/haproxy/errors/400.http
    errorfile 403 /etc/haproxy/errors/403.http
    errorfile 408 /etc/haproxy/errors/408.http
    errorfile 500 /etc/haproxy/errors/500.http
    errorfile 502 /etc/haproxy/errors/502.http
    errorfile 503 /etc/haproxy/errors/503.http
    errorfile 504 /etc/haproxy/errors/504.http

frontend http_front
    bind *:80
    stats uri /haproxy?stats
    default_backend http_back

backend http_back
    balance roundrobin
    # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼1ã®ã¿ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™
    server web1 web1:80 check
    # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼2ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã•ã‚Œã¦ã„ã¾ã™
    # server web2 web2:80 check

listen stats
    bind *:1936
    stats enable
    stats hide-version
    stats realm Haproxy\ Statistics
    stats uri /
    stats auth admin:admin
</file>

<file path="tools/cli/game.py">
#!/usr/bin/env python3
"""
Skillmap CLI - Ops Essentials æ¼”ç¿’ç”¨ãƒ„ãƒ¼ãƒ«

ä½¿ã„æ–¹:
  python3 tools/cli/game.py play <game_id>

åˆ©ç”¨å¯èƒ½ãªã‚²ãƒ¼ãƒ :
  01-network: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã®ãƒ‡ãƒãƒƒã‚°æ¼”ç¿’
"""
import subprocess
import sys
import argparse
import time
from pathlib import Path
from typing import Optional

def print_header():
    """Print the tool header."""
    print("""
    ____  _ _       _ __  __       _   _             
   / ___|(_) | __ _|  \\/  | __ _| |_| |    ___  ___
   \\___ \\| | |/ _` | |\\/| |/ _` | __| |   / _ \\/ __|
    ___) | | | (_| | |  | | (_| | |_| |__|  __/\\__ \\
   |____/|_|_|\\__,_|_|  |_|\\__,_|\\__|_____\\___||___/
   
   Ops Essentials - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¼”ç¿’ãƒ„ãƒ¼ãƒ«
   """)

def get_available_games() -> list:
    """Get list of available games."""
    games_dir = Path(__file__).parent.parent.parent / "ops-essentials" / "games"
    if not games_dir.exists():
        return []
    return [d.name for d in games_dir.iterdir() if d.is_dir()]

def play_game(game_id: str) -> bool:
    """Play a specific game.
    
    Args:
        game_id: ID of the game to play
        
    Returns:
        bool: True if the game was completed successfully
    """
    game_dir = Path(__file__).parent.parent.parent / "ops-essentials" / "games" / game_id
    checker = game_dir / "checker.py"
    
    if not checker.exists():
        print(f"âŒ ã‚¨ãƒ©ãƒ¼: ã‚²ãƒ¼ãƒ  '{game_id}' ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã‹ã€checker.py ãŒå­˜åœ¨ã—ã¾ã›ã‚“")
        return False
    
    print(f"\nğŸ® ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã—ã¾ã™: {game_id}")
    print("-" * 50)
    
    # Check if the game has a quest file
    quest_file = game_dir / "quest.md"
    if quest_file.exists():
        with open(quest_file, 'r', encoding='utf-8') as f:
            print("\nğŸ“œ ãƒŸãƒƒã‚·ãƒ§ãƒ³æ¦‚è¦:")
            print("-" * 30)
            print(f.read())
    
    print("\nğŸ” ãƒã‚§ãƒƒã‚¯ã‚’é–‹å§‹ã—ã¾ã™...")
    print("-" * 50)
    
    try:
        # Run the checker with a timeout of 30 seconds
        start_time = time.time()
        result = subprocess.run(
            [sys.executable, str(checker)],
            cwd=game_dir,
            check=False,
            text=True,
            capture_output=True
        )
        elapsed_time = time.time() - start_time
        
        # Print the output
        if result.stdout:
            print(result.stdout)
        if result.stderr:
            print(result.stderr, file=sys.stderr)
        
        if result.returncode == 0:
            print("\n" + "=" * 50)
            print("ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ ã‚¯ãƒªã‚¢ã§ã™ï¼")
            print(f"â±ï¸  ã‹ã‹ã£ãŸæ™‚é–“: {elapsed_time:.1f}ç§’")
            print("=" * 50)
            return True
        else:
            print("\n" + "=" * 50)
            print("âŒ ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã¦ãã ã•ã„")
            print("=" * 50)
            return False
            
    except subprocess.TimeoutExpired:
        print("\nğŸ•’ ãƒã‚§ãƒƒã‚¯ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã¦ã„ã¾ã™ã€‚")
        return False
    except Exception as e:
        print(f"\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {str(e)}")
        return False

def main():
    """Main entry point for the CLI."""
    print_header()
    
    parser = argparse.ArgumentParser(description='Skillmap CLI tool for Ops Essentials')
    subparsers = parser.add_subparsers(dest='command', help='åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰')
    
    # Play command
    play_parser = subparsers.add_parser('play', help='ã‚²ãƒ¼ãƒ ã‚’ãƒ—ãƒ¬ã‚¤ã™ã‚‹')
    play_parser.add_argument('game_id', help='ãƒ—ãƒ¬ã‚¤ã™ã‚‹ã‚²ãƒ¼ãƒ ã®ID')
    
    args = parser.parse_args()
    
    if args.command == 'play':
        available_games = get_available_games()
        if args.game_id not in available_games:
            print(f"\nâŒ ã‚¨ãƒ©ãƒ¼: ã‚²ãƒ¼ãƒ  '{args.game_id}' ã¯å­˜åœ¨ã—ã¾ã›ã‚“")
            print("\nåˆ©ç”¨å¯èƒ½ãªã‚²ãƒ¼ãƒ :")
            for game in available_games:
                print(f"  - {game}")
            sys.exit(1)
            
        success = play_game(args.game_id)
        sys.exit(0 if success else 1)
    else:
        parser.print_help()
        print("\nåˆ©ç”¨å¯èƒ½ãªã‚²ãƒ¼ãƒ :")
        for game in get_available_games():
            print(f"  - {game}")
        sys.exit(1)

if __name__ == '__main__':
    try:
        main()
    except KeyboardInterrupt:
        print("\n\nğŸ‘‹ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†ã—ã¾ã™")
        sys.exit(0)
</file>

<file path=".gitignore">
# Python
__pycache__/
*.py[cod]
*.pyc
.pytest_cache/

# Node
node_modules/
package-lock.json

# Environment variables
.env

# IDE
.vscode/
.idea/

# Local development
score.json

# Editor files
*.swp
*~
.DS_Store
</file>

<file path="docker-compose.yml">
version: "3.9"
services:
  docs:
    image: python:3.10-slim
    volumes:
      - .:/docs
    working_dir: /docs
    ports:
      - "8000:8000"
    command: >
      sh -c "pip install mkdocs-material mkdocs-mermaid2-plugin && 
             mkdocs serve --dev-addr=0.0.0.0:8000"

  game:
    depends_on: [network_lab]
    image: python:3.12-slim
    working_dir: /work
    volumes: [".:/work"]
    command: "sleep infinity"
    profiles: ["game"]

  network_lab:
    profiles: ["game"]
    image: nginx:1.25-alpine
    ports: ["8080:80"]
</file>

<file path="mkdocs.yml">
site_name: Skillmap.dev â€“ Ops Essentials
repo_url: https://github.com/atsushi-ambo/skillmap.dev

theme:
  name: material
  palette:
    - scheme: default
      primary: indigo
      accent: light blue
  logo: img/icons/cloud.svg
  features:
    - navigation.tabs
    - navigation.expand
    - content.code.annotate

markdown_extensions:
  - admonition
  - pymdownx.superfences
  - pymdownx.tabbed
  - attr_list
  - md_in_html
  - pymdownx.snippets

plugins:
  - search
  - mermaid2:
      arguments:
        theme: default
        themeVariables:
          primaryColor: '#3f51b5'
          primaryTextColor: '#fff'
          primaryBorderColor: '#3f51b5'

nav:
  - Home: index.md
  - Ops Essentials:
      - Overview: ops-essentials/index.md
      - Level 1 â€“ Foundations: ops-essentials/level1.md
      - Level 2 â€“ Ops Routine: ops-essentials/level2.md
      - Level 3 â€“ Scale & HA: ops-essentials/level3.md
      - Level 4 â€“ Design & Cost: ops-essentials/level4.md
</file>

<file path="README.md">
# Skillmap.dev - Ops Essentials

## æ¦‚è¦

Skillmap.dev ã¯ã€ITã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å‘ã‘ã®å®Ÿè·µçš„ãªæ¼”ç¿’ç’°å¢ƒã‚’æä¾›ã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚
ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚„ã‚·ã‚¹ãƒ†ãƒ é‹ç”¨ã®åŸºæœ¬ã‚’å­¦ã¶ãŸã‚ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨æ¼”ç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## æ©Ÿèƒ½

- **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: æ¦‚å¿µã‚’å­¦ã¶ãŸã‚ã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ™ãƒ¼ã‚¹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- **ãƒãƒ³ã‚ºã‚ªãƒ³æ¼”ç¿’**: å®Ÿéš›ã®ç’°å¢ƒã§è©¦ã—ãªãŒã‚‰å­¦ã¹ã‚‹å®Ÿè·µçš„ãªèª²é¡Œ
- **Mermaid å›³è§£**: æ¦‚å¿µã‚’è¦–è¦šçš„ã«ç†è§£ã™ã‚‹ãŸã‚ã®ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ 

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å‰ææ¡ä»¶

- Docker ã¨ Docker Compose ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨

### ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®å®Ÿè¡Œ

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³:
   ```bash
   git clone https://github.com/atsushi-ambo/skillmap.dev.git
   cd skillmap.dev
   ```

2. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•:
   ```bash
   docker compose up docs
   ```

3. ãƒ–ãƒ©ã‚¦ã‚¶ã§ [http://localhost:8000](http://localhost:8000) ã«ã‚¢ã‚¯ã‚»ã‚¹

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ§‹æˆ

- **Ops Essentials**: ã‚¤ãƒ³ãƒ•ãƒ©é‹ç”¨ã®åŸºç¤ã‹ã‚‰ã‚³ã‚¹ãƒˆè¨­è¨ˆã¾ã§
  - Level 1: åŸºç¤çŸ¥è­˜ã¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
  - Level 2: é‹ç”¨æ¥­å‹™ã®åŸºæœ¬
  - Level 3: ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã¨é«˜å¯ç”¨æ€§
  - Level 4: è¨­è¨ˆã¨ã‚³ã‚¹ãƒˆæœ€é©åŒ–

2. ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’è¡¨ç¤º:
   ```bash
   docker compose --profile slides up
   ```
   ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:1948 ã‚’é–‹ãã¾ã™

3. æ¼”ç¿’ã‚’é–‹å§‹:
   ```bash
   # ã‚²ãƒ¼ãƒ ç’°å¢ƒã‚’èµ·å‹•
   docker compose --profile game up -d
   
   # æ¼”ç¿’ã‚’é–‹å§‹
   python3 tools/cli/game.py play 01-network
   ```

## åˆ©ç”¨å¯èƒ½ãªæ¼”ç¿’

### 1. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã®ãƒ‡ãƒãƒƒã‚°

- **ç›®çš„**: Docker ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã¨ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°ã‚’å­¦ã¶
- **å­¦ç¿’å†…å®¹**:
  - ã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°
  - Nginx ã®åŸºæœ¬çš„ãªè¨­å®š
  - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

- ã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ãªã„å ´åˆ:
  ```bash
  # ãƒ­ã‚°ã‚’ç¢ºèª
  docker logs skillmapdev-network_lab-1
  
  # ã‚³ãƒ³ãƒ†ãƒŠã‚’å†èµ·å‹•
  docker compose --profile game down
  docker compose --profile game up -d
  ```

- ãƒãƒ¼ãƒˆãŒç«¶åˆã™ã‚‹å ´åˆ:
  ```bash
  # ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆã‚’ç¢ºèª
  lsof -i :8080
  
  # åˆ¥ã®ãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€docker-compose.yml ã‚’ç·¨é›†
  ```

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License
</file>

</files>
